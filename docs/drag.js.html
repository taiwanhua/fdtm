<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Drag.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Drag.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, {useEffect} from "react"
import styled from 'styled-components';

/**
 * 拖拽視窗樣式
 *&lt;br>
 * &lt;br>
 * Description:&lt;br>
 * 拖拽視窗樣式，待補
 *
 * @file: Drag.js
 * @constant  Styled-component_拖拽視窗:Dragwindow
 * @author: Arhua Ho
 * @date: 2019/7/27
 */
const Dragwindow = styled.div`
    position: absolute;
    top: 100px;
    left: 100px;
    width: 300px;
    height: 160px;
    background: #252525;
    border: 1px solid #414141;
    border-radius: 5px;
    box-shadow: 0 1px 3px 2px #666;
    
    
     &amp; #title {    
        position: relative;  //
        height: 27px;
        margin-bottom: 5px;
        background: #6c7b95;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
        
        h2 {
            font-size: 14px;
            height: 27px;
            line-height: 24px;
            border-bottom: 1px solid #A1B4B0;
            padding-left: 5px;
         }
        
        div {
          position: absolute;
          height: 19px;
          top: 2px;
          right: 0;
        
           a {
                float: left;
                width: 21px;
                height: 19px;
                display: block;
                margin-left: 5px;
            }
           
           #max{
                background: url("./img/maximize.png") no-repeat;
                background-size: contain;
            }
            
           #min{
                background: url("./img/minimize.png") no-repeat;
                background-size: contain;
            }
            
           #revert{
                background: url("./img/resize.png") no-repeat;
                background-size: contain;
                display: none;
            }
            
           #close{
                background: url("./img/cancel.png") no-repeat;
                background-size: contain;
            }
         }
      }  
       
     &amp; #content{
        overflow: auto;
        padding: 0 5px;
        width:285px; //-15px
        height: 123px; //-37
      }
     
     &amp; #resizeBR{
        position: absolute;
        width: 14px;
        height: 14px;
         right: 0;
        bottom: 0;
        overflow: hidden;
        cursor: nw-resize;
     }
     #resizeL, #resizeT, #resizeR, #resizeB, #resizeLT, #resizeTR, #resizeLB{
        position: absolute;
        background: #000;
        overflow: hidden;
        opacity: 0;
        filter: alpha(opacity=0);
      }
     
     #resizeL, #resizeR{
        top: 0;
        width: 5px;
        height: 100%;
        cursor: w-resize;
      }
     
     #resizeR{
        right: 0;
      }
      
     #resizeT, #resizeB{
        width: 100%;
        height: 5px;
        cursor: n-resize;
      }
      
     #resizeT{
        top: 0;
      }
      
     #resizeB{
        bottom: 0;
      }

     #resizeLT, #resizeTR, #resizeLB{
        width: 8px;
        height: 8px;
        background: #FF0;
      }

     #resizeLT{
        top: 0;
        left: 0;
        cursor: nw-resize;
      }

     #resizeTR{
        top: 0;
        right: 0;
        cursor: ne-resize;
      }

     #resizeLB{
        left: 0;
        bottom: 0;
        cursor: ne-resize;
      }
`;

/**
 * 透過ID取得DOM函數
 *&lt;br>
 * &lt;br>
 * Description:&lt;br>
 * 透過ID取得DOM
 *
 * @file: Drag.js
 * @method   function_透過ID取得DOM函數: byId
 * @param {object_or_string} object_or_string - 欲取得DOM的元素其ID
 * @return {DOM} object_or_string - 透過ID取得的DOM
 * @author: Arhua Ho
 * @date: 2019/7/27
 */
const byId = function (object_or_string) {
    //因為使用ID不需要透過此函數，可直接調用；亦提供方法
    // document.getElementById()
    // document.getElementsByClassName()
    // document.getElementsByTagName()
    // document.getElementsByName()
    // document.getElementsByTagNameNS()
    // document.getSelection()
    if (typeof object_or_string === "string") {
        // console.log("true");
        return document.getElementById(object_or_string);
    }
    if (typeof object_or_string === "object") {
        return object_or_string;
    }
}
const dragMinWidth = 250;//可拖拽視窗縮到最小寬度
const dragMinHeight = 124;//可拖拽視窗縮到最小高度

/**
 * 拖拽視窗函數
 *&lt;br>
 * &lt;br>
 * Description:&lt;br>
 * 拖拽視窗函數，待補
 *
 * @file: Drag.js
 * @function  function_拖拽視窗函數: drag
 * @param {type} oDrag - 拖拽視窗DOM
 * @param {type} handle - 拖拽視窗標題DOM
 * @author: Arhua Ho
 * @date: 2019/7/27
 */
const drag = (oDrag, content, handle) => {
    let disY = 0; //鼠標對於當前瀏覽器窗口的X座標，預設0
    let disX = 0; //鼠標對於當前瀏覽器窗口的Y座標，預設0
    let oMin = byId("min"); //最小化按鈕
    let oMax = byId("max"); //最大化按鈕
    let oRevert = byId("revert"); //還原按鈕
    let oClose = byId("close"); //關閉按鈕
    handle = handle || oDrag;
    handle.style.cursor = "move"; //設定鼠標樣式為move

    handle.onmousedown = function (event) {
        disX = event.clientX - oDrag.offsetLeft;//(鼠標對於當前瀏覽器窗口的X座標 - 瀏覽器窗口最左邊到DOM元素左邊Border外的長度)
        disY = event.clientY - oDrag.offsetTop;//(鼠標對於當前瀏覽器窗口的Y座標 - 瀏覽器窗口最上邊到DOM元素上邊Border外的長度)
        document.onmousemove = function (event) {
            let iL = event.clientX - disX; //當前onmousemove事件鼠標對於當前瀏覽器窗口的X座 - onmousedown的disX座標
            let iT = event.clientY - disY; //當前onmousemove事件鼠標對於當前瀏覽器窗口的Y座 - onmousedown的disY座標
            let maxL = document.documentElement.clientWidth - oDrag.offsetWidth; //設定DOM元素left的最大值，當前瀏覽器窗口的X軸寬度 - DOM元素寬度
            let maxT = document.documentElement.clientHeight - oDrag.offsetHeight; //設定DOM元素top的最大值，當前瀏覽器窗口的Y軸高度 - DOM元素高度
            iL &lt;= 0 &amp;&amp; (iL = 0); //設定當DOM元素left的值比0小，就設成0，就是不讓DOM元素被畫面切到
            iT &lt;= 0 &amp;&amp; (iT = 0); //設定當DOM元素top的值比0小，就設成0，就是不讓DOM元素被畫面切到
            iL >= maxL &amp;&amp; (iL = maxL);//設定當DOM元素left的值比maxL大，就設成maxL，就是不讓DOM元素被畫面切到
            iT >= maxT &amp;&amp; (iT = maxT);//設定當DOM元素left的值比maxT大，就設成maxT，就是不讓DOM元素被畫面切到

            oDrag.style.left = iL + "px"; //設定DOM元素left位置
            oDrag.style.top = iT + "px"; //設定DOM元素top位置

            return false //去除預設事件
        };

        document.onmouseup = function () {
            document.onmousemove = null; //清除事件
            document.onmouseup = null; //清除事件
            this.releaseCapture &amp;&amp; this.releaseCapture()// 設定事件在當前DOM釋放
        };
        this.setCapture &amp;&amp; this.setCapture(); // 設定事件鎖定在當前DOM
        return false  //去除預設事件
    };

    //最大化按鈕
    oMax.onclick = function () {
        oDrag.style.top = oDrag.style.left = 0;//設定DOM元素left位置為0
        oDrag.style.width = document.documentElement.clientWidth - 2 + "px"; //將DOM元素寬度增加到瀏覽器窗口 - border(為 1*2)
        oDrag.style.height = document.documentElement.clientHeight - 2 + "px"; //將DOM元素高度增加到瀏覽器窗口 - border(為 1*2)
        content.style.width = parseInt(oDrag.style.width, 10) - 15 + "px";//將content寬度增加到 oDrag.style.width - 15
        content.style.height = parseInt(oDrag.style.height, 10) - 37 + "px";//將content高度增加到 oDrag.style.width - 37
        this.style.display = "none"; //隱藏最大化按鈕
        oRevert.style.display = "block"; //取消隱藏最小化按鈕
    };
    //還原按鈕
    oRevert.onclick = function () {
        oDrag.style.width = dragMinWidth + "px";//設定DOM元素left位置為dragMinWidth
        oDrag.style.height = dragMinHeight + "px";//設定DOM元素top位置為dragMinHeight
        oDrag.style.left = (document.documentElement.clientWidth - oDrag.offsetWidth) / 2 + "px"; //將DOM元素寬度還原到 (瀏覽器窗口 - DOM元素寬度) / 2
        oDrag.style.top = (document.documentElement.clientHeight - oDrag.offsetHeight) / 2 + "px"; //將DOM元素高度還原到 (瀏覽器窗口 - DOM元素高度) / 2
        content.style.width = parseInt(oDrag.style.width, 10) - 15 + "px";//將content寬度增加到 oDrag.style.width - 15
        content.style.height = parseInt(oDrag.style.height, 10) - 37 + "px";//將content高度增加到 oDrag.style.width - 37
        this.style.display = "none";//隱藏最小化按鈕
        oMax.style.display = "block";//取消隱藏最大化按鈕
    };
    //最小化、關閉按鈕
    oMin.onclick = oClose.onclick = function () {
        oDrag.style.display = "none";//隱藏DOM元素
        let oA = document.createElement("a"); //添加一個DOM元素，作為縮小視窗
        oA.id = "open"; //添加id給縮小視窗
        oA.href = "javascript:;";//添加一個href偽協議，代表什麼都不會執行，隨後會添加回調事件
        oA.title = "還原";//添加title給縮小視窗
        document.body.appendChild(oA);//添加縮小視窗DOM到body內
        oA.onclick = function () { //添加縮小視窗的回調事件
            oDrag.style.display = "block"; //隱藏縮小視窗
            document.body.removeChild(this); //移除縮小視窗DOM元素
            this.onclick = null; //清除當前縮小視窗DOM的onclick事件
        };
    };
    //阻止冒泡
    oMin.onmousedown = oMax.onmousedown = oClose.onmousedown = function (event) { //一起綁定onmousedown事件
        this.onfocus = function () { //用來去除跳轉偽協議的虛框線
            this.blur()
        };
        (event || window.event).cancelBubble = true //阻止冒泡事件
    };
}

/**
 * 改變可拖拽視窗大小函數
 * &lt;br>
 * &lt;br>
 * Description: &lt;br>
 * 改變大小函數，詳細待補
 *
 * @file: Drag.js
 * @function  function_改變可拖拽視窗大小函數: resize
 * @param {DOM} oParent - 包裹handle的父DOM，即可拖拽視窗
 * @param {DOM} handle - 要往某方向拉伸，被點擊的DOM
 * @param {boolean} isLeft - handle是否位於oParent左測
 * @param {boolean} isTop - handle是否位於oParent上測
 *  @param {boolean} lockX - 是否垂直拉伸，即X軸不改變
 *  @param {boolean} lockY - 是否水平拉伸，即Y軸不改變
 * @author: Arhua Ho
 * @date: 2019/7/26
 */
function resize(oParent, content, handle, isLeft, isTop, lockX, lockY) {
    handle.onmousedown = function (event) {//將被點擊的DOM綁定onmousedown事件
        let disX = event.clientX - handle.offsetLeft;//(鼠標對於當前瀏覽器窗口的X座標 - 瀏覽器窗口最左邊到被點擊的DOM元素左邊Border外的長度)
        let disY = event.clientY - handle.offsetTop;//(鼠標對於當前瀏覽器窗口的Y座標 - 瀏覽器窗口最左邊到被點擊的DOM元素左邊Border外的長度)
        let iParentTop = oParent.offsetTop;//瀏覽器窗口最上邊到可拖拽視窗上邊Border外的長度
        let iParentLeft = oParent.offsetLeft;//瀏覽器窗口最左邊到可拖拽視窗左邊Border外的長度
        let iParentWidth = oParent.offsetWidth;//可拖拽視窗寬度
        let iParentHeight = oParent.offsetHeight;//可拖拽視窗高度
        document.onmousemove = function (event) {//綁定onmousemove事件
            let iL = event.clientX - disX;//當前onmousemove事件鼠標對於當前瀏覽器窗口的X座標 - onmousedown的disX座標，往左為負，往右為正 (即相對於disX移動多少)
            let iT = event.clientY - disY;//當前onmousemove事件鼠標對於當前瀏覽器窗口的Y座標 - onmousedown的disY座標，往上為負，往下為正 (即相對於disY移動多少)
            let maxW = document.documentElement.clientWidth - oParent.offsetLeft - 2; //即可拖拽視窗左邊Border內到瀏覽器窗口最右邊的長度 - 2  (求最大可以變到多大)
            let maxH = document.documentElement.clientHeight - oParent.offsetTop - 2; //即可拖拽視窗上邊Border內到瀏覽器窗口最下邊的長度 - 2  (求最大可以變到多大)
            let iW = isLeft ? iParentWidth - iL : handle.offsetWidth + iL;//若isLeft為true則即可拖拽視窗寬度+相對於disX移動多少距離  (求目前onmousemove讓可拖拽視窗縮小或變大多少)
            let iH = isTop ? iParentHeight - iT : handle.offsetHeight + iT;//若isTop為true則即可拖拽視窗高度+相對於disY移動多少距離  (求目前onmousemove讓可拖拽視窗縮小或變大多少)
            isLeft &amp;&amp; (oParent.style.left = iParentLeft + iL + "px");//即設定可拖拽視窗left為 ( onmousedown時瀏覽器窗口最左邊到可拖拽視窗左邊Border外的長度 - 相對於disX移動多少 )，為了給可拖拽視窗定左上角座標用
            isTop &amp;&amp; (oParent.style.top = iParentTop + iT + "px");//即設定可拖拽視窗top為 ( onmousedown時瀏覽器窗口最上邊到可拖拽視窗上邊Border外的長度 - 相對於disY移動多少 )，為了給可拖拽視窗定左上角座標用
            iW &lt; dragMinWidth &amp;&amp; (iW = dragMinWidth);//設定若目前onmousemove讓可拖拽視窗寬度縮小到比可拖拽視窗縮到最小寬度還小，則不讓他繼續縮小
            iW > maxW &amp;&amp; (iW = maxW);//設定若目前onmousemove讓可拖拽視窗寬度放大到比可拖拽視窗放到最大寬度還大，則不讓他繼續放大
            lockX || (oParent.style.width = iW + "px");//如果是水平拉伸，則返回 lockX (true，即不執行 oParent.style.width = iW + "px")，就是鎖定X軸座標；不然寬度就隨onmousemove變化
            lockX || (content.style.width = parseInt(oParent.style.width, 10) - 15 + "px");//如果是水平拉伸，則返回 lockX (true，即不執行 parseInt(oParent.style.width, 10) - 15 + "px")，就是鎖定X軸座標；不然content寬度就隨onmousemove變化
            iH &lt; dragMinHeight &amp;&amp; (iH = dragMinHeight);//設定若目前onmousemove讓可拖拽視窗高度縮小到比可拖拽視窗縮到最小高度還小，則不讓他繼續縮小
            iH > maxH &amp;&amp; (iH = maxH);//設定若目前onmousemove讓可拖拽視窗高度放大到比可拖拽視窗放到最大高度還大，則不讓他繼續放大
            lockY || (oParent.style.height = iH + "px");//如果是垂直拉伸，則返回 lockY (true，即不執行 oParent.style.height = iH + "px")，就是鎖定Y軸座標；不然高度就隨onmousemove變化
            lockY || (content.style.height = parseInt(oParent.style.height, 10) - 37 + "px");//如果是垂直拉伸，則返回 lockY (true，即不執行  parseInt(oParent.style.height, 10) - 37 + "px"))，就是鎖定Y軸座標；不然content高度就隨onmousemove變化
            if ((isLeft &amp;&amp; iW == dragMinWidth) || (isTop &amp;&amp; iH == dragMinHeight)) document.onmousemove = null;//如果高度或寬度任一個縮到比最小高度或寬度還小，就清除onmousemove事件
            return false;
        };
        document.onmouseup = function () {//綁定onmouseup事件
            document.onmousemove = null;//清除onmousemove事件
            document.onmouseup = null;////清除onmouseup事件
        };
        return false;
    }
};

/**
 * 拖拽視窗組件
 *&lt;br>
 * &lt;br>
 * Description:&lt;br>
 * 創建一個可以拖動、八方位伸縮、最大最小化、還原、關閉與限制大小的視窗，
 * 透過將其他組件放入id="content"的div中，達到視窗化的效果
 *
 * @file: Drag.js
 * @module React-export_拖拽視窗組件: Drag
 * @see   url   or  {FunctionName#var}
 * @param {props} props - 外部傳進來的一些初始參數
 * @author: Arhua Ho
 * @date: 2019/7/27
 */
const Drag = (props) => {
console.log(props)
    useEffect(() => {
        let oDrag = document.getElementById("drag");
        let oContent = document.getElementById("content");
        let oTitle = byId("title");
        let oL = byId("resizeL");
        let oT = byId("resizeT");
        let oR = byId("resizeR");
        let oB = byId("resizeB");
        let oLT = byId("resizeLT");
        let oTR = byId("resizeTR");
        let oBR = byId("resizeBR");
        let oLB = byId("resizeLB");
        drag(oDrag, oContent, oTitle);
        // oDrag.style.position = "absolute";
        console.log(oLB)
        //四角
        resize(oDrag, oContent, oLT, true, true, false, false);
        resize(oDrag, oContent, oTR, false, true, false, false);
        resize(oDrag, oContent, oBR, false, false, false, false);
        resize(oDrag, oContent, oLB, true, false, false, false);
        //四边
        resize(oDrag, oContent, oL, true, false, false, true);
        resize(oDrag, oContent, oT, false, true, true, false);
        resize(oDrag, oContent, oR, false, false, false, true);
        resize(oDrag, oContent, oB, false, false, true, false);
        oDrag.style.left = (document.documentElement.clientWidth - oDrag.offsetWidth) / 2 + "px";//初始位置
        oDrag.style.top = (document.documentElement.clientHeight - oDrag.offsetHeight) / 2 + "px";//初始位置

        window.onresize = function () {
            let oDrag = document.getElementById("drag");
            let oTitle = byId("title");
            let oL = byId("resizeL");
            let oT = byId("resizeT");
            let oR = byId("resizeR");
            let oB = byId("resizeB");
            let oLT = byId("resizeLT");
            let oTR = byId("resizeTR");
            let oBR = byId("resizeBR");
            let oLB = byId("resizeLB");
            drag(oDrag, oContent, oTitle);
            //四角
            resize(oDrag, oContent, oLT, true, true, false, false);
            resize(oDrag, oContent, oTR, false, true, false, false);
            resize(oDrag, oContent, oBR, false, false, false, false);
            resize(oDrag, oContent, oLB, true, false, false, false);
            //四边
            resize(oDrag, oContent, oL, true, false, false, true);
            resize(oDrag, oContent, oT, false, true, true, false);
            resize(oDrag, oContent, oR, false, false, false, true);
            resize(oDrag, oContent, oB, false, false, true, false);
            // oDrag.style.position = "absolute";
            oDrag.style.left = (document.documentElement.clientWidth - oDrag.offsetWidth) / 2 + "px";//初始位置
            oDrag.style.top = (document.documentElement.clientHeight - oDrag.offsetHeight) / 2 + "px";//初始位置
        }


    }, [document.body.clientWidth, document.body.clientHeight]);


    return (
        &lt;Dragwindow id="drag">
            &lt;div id="title">
                &lt;h2>这是一个可以拖动的窗口&lt;/h2>
                &lt;div>
                    &lt;a id="min" href="javascript:;" title="最小化">&lt;/a>
                    &lt;a id="max" href="javascript:;" title="最大化">&lt;/a>
                    &lt;a id="revert" href="javascript:;" title="還原">&lt;/a>
                    &lt;a id="close" href="javascript:;" title="關閉">&lt;/a>
                &lt;/div>
            &lt;/div>
            &lt;div id="resizeL">&lt;/div>
            &lt;div id="resizeT">&lt;/div>
            &lt;div id="resizeR">&lt;/div>
            &lt;div id="resizeB">&lt;/div>
            &lt;div id="resizeLT">&lt;/div>
            &lt;div id="resizeTR">&lt;/div>
            &lt;div id="resizeBR">&lt;/div>
            &lt;div id="resizeLB">&lt;/div>
            &lt;div id="content">
                {props.children}
            &lt;/div>

        &lt;/Dragwindow>)

}

export default Drag;







</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-React-export_%25E6%258B%2596%25E6%258B%25BD%25E8%25A6%2596%25E7%25AA%2597%25E7%25B5%2584%25E4%25BB%25B6_%2520Drag.html">React-export_拖拽視窗組件: Drag</a></li></ul><h3>Global</h3><ul><li><a href="global.html#function_%25E6%258B%2596%25E6%258B%25BD%25E8%25A6%2596%25E7%25AA%2597%25E5%2587%25BD%25E6%2595%25B8:drag">function_拖拽視窗函數: drag</a></li><li><a href="global.html#function_%25E6%2594%25B9%25E8%25AE%258A%25E5%258F%25AF%25E6%258B%2596%25E6%258B%25BD%25E8%25A6%2596%25E7%25AA%2597%25E5%25A4%25A7%25E5%25B0%258F%25E5%2587%25BD%25E6%2595%25B8:resize">function_改變可拖拽視窗大小函數: resize</a></li><li><a href="global.html#function_%25E9%2580%258F%25E9%2581%258EID%25E5%258F%2596%25E5%25BE%2597DOM%25E5%2587%25BD%25E6%2595%25B8:byId">function_透過ID取得DOM函數: byId</a></li><li><a href="global.html#Styled-component_%25E6%258B%2596%25E6%258B%25BD%25E8%25A6%2596%25E7%25AA%2597:Dragwindow">Styled-component_拖拽視窗:Dragwindow</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sat Jul 27 2019 22:44:20 GMT+0800 (GMT+08:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
